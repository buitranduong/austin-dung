/*
  Note: We have included the plugin in the same JavaScript file as the TinyMCE
  instance for display purposes only. Tiny recommends not maintaining the plugin
  with the TinyMCE instance and using the `external_plugins` option.
*/
tinymce.PluginManager.add('custom_query', (editor, url) => {
    const openDialog = () => editor.windowManager.open({
        title: 'List sim',
        body: {
            type: 'panel',
            items: [
                {
                    type: 'input',
                    name: 'dauso',
                    label: 'Đầu số'
                },
                {
                    type: 'input',
                    name: 'cat_ids',
                    label: 'Mã danh mục'
                },
                {
                    type: 'input',
                    name: 'telco_id',
                    label: 'Mã nhà mạng'
                },
                {
                    type: 'input',
                    name: 'min_price',
                    label: 'Giá từ'
                },
                {
                    type: 'input',
                    name: 'max_price',
                    label: 'Đến giá'
                },
                {
                    type: 'input',
                    name: 's_id',
                    label: 'Mã kho'
                },
                {
                    type: 'input',
                    name: 'limit',
                    label: 'Số lượng'
                },
            ]
        },
        buttons: [
            {
                type: 'cancel',
                text: 'Close'
            },
            {
                type: 'submit',
                text: 'Insert',
                buttonType: 'primary'
            }
        ],
        onSubmit: (api) => {
            const data = api.getData();
            /* Insert content when the window form is submitted */
            editor.insertContent(`[custom_query dauso="${data.dauso}" cat_ids="${data.cat_ids}" telco_id="${data.telco_id}" min_price="${data.min_price}" max_price="${data.max_price}" s_id="${data.s_id}" limit="${data.limit}"]`);
            api.close();
        }
    });
    /* Add a button that opens a window */
    editor.ui.registry.addButton('custom_query', {
        icon: 'footnote',
        tooltip: 'List sim',
        onAction: () => {
            /* Open window */
            openDialog();
        }
    });
    /* Adds a menu item, which can then be included in any menu via the menu/menubar configuration */
    editor.ui.registry.addMenuItem('custom_query', {
        text: 'List sim',
        onAction: () => {
            /* Open window */
            openDialog();
        }
    });
    /* Return the metadata for the help plugin */
    return {
        getMetadata: () => ({
            name: 'List sim embed',
            url: 'https://simthanglong.vn'
        })
    };
});

